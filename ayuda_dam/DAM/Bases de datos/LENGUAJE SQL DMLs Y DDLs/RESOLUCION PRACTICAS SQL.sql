/*
PRACTICAS DML 2ª EVALUACION

MANUEL GUTIERREZ TORRERO

1º DE D.A.M.

*/

/*PRACTICA 1*/
DROP TABLE FABRICANTE CASCADE CONSTRAINTS;
DROP TABLE ARTICULO CASCADE CONSTRAINTS;
CREATE TABLE FABRICANTE(
   IDEFAB VARCHAR2(12),
   NOMFAB VARCHAR2(12),
   CONSTRAINT PK_FABRICANTE PRIMARY KEY(IDEFAB));

CREATE TABLE ARTICULO(
   IDEART VARCHAR2(12),
   IDEFAB VARCHAR2(12),
   NOMART VARCHAR2(12),
   PRECIO NUMBER(8,2),
   CONSTRAINT PK_IDEART PRIMARY KEY(IDEART),
   CONSTRAINT FK_ARTICULO_FABRICANTE FOREIGN KEY (IDEFAB) REFERENCES FABRICANTE(IDEFAB));

INSERT INTO FABRICANTE (IDEFAB,NOMFAB) VALUES (1,'FORD');
INSERT INTO FABRICANTE (IDEFAB,NOMFAB) VALUES (2,'VOLKSWAGEN');
INSERT INTO FABRICANTE (IDEFAB,NOMFAB) VALUES (3,'OPEL');
INSERT INTO FABRICANTE (IDEFAB,NOMFAB) VALUES (4,'RENAULT');
COMMIT;

INSERT INTO ARTICULO (IDEART,IDEFAB,NOMART,PRECIO) VALUES (12,1,'MONDEO',20000.0);
INSERT INTO ARTICULO (IDEART,IDEFAB,NOMART,PRECIO) VALUES (22,2,'PASSAT',21000.0);
INSERT INTO ARTICULO (IDEART,IDEFAB,NOMART,PRECIO) VALUES (32,2,'GOLF',19500.0);
INSERT INTO ARTICULO (IDEART,IDEFAB,NOMART,PRECIO) VALUES (42,4,'MEGANE',19000.0);
COMMIT;
/*1.1*/
SELECT NOMART FROM ARTICULO;
/*1.2*/
SELECT NOMART,PRECIO FROM ARTICULO;
/*1.3*/
SELECT NOMART,PRECIO FROM ARTICULO WHERE PRECIO<=20000;
/*1.4*/
SELECT NOMART,PRECIO FROM ARTICULO WHERE (PRECIO>=10000 AND PRECIO<=20000);
/*1.5*/
SELECT NOMART,(PRECIO*166.386) FROM ARTICULO;
/*1.6*/
SELECT AVG(PRECIO)FROM ARTICULO;
/*1.7*/
SELECT AVG(PRECIO)FROM ARTICULO WHERE IDEFAB=2;
/*1.8*/
SELECT COUNT(PRECIO) FROM ARTICULO WHERE PRECIO>=19500;
/*1.9*/
SELECT NOMART,PRECIO FROM ARTICULO WHERE (PRECIO>=19500) ORDER BY PRECIO DESC,NOMART ASC;
/*1.10*/
SELECT B.NOMART,B.PRECIO,A.NOMFAB
FROM FABRICANTE A INNER JOIN ARTICULO B
ON (A.IDEFAB=B.IDEFAB);
/*1.11*/

SELECT IDEFAB,AVG(PRECIO)
FROM ARTICULO
GROUP BY IDEFAB;
/*1.12*/
SELECT AVG(B.PRECIO),A.NOMFAB
FROM FABRICANTE A INNER JOIN ARTICULO B 
ON (A.IDEFAB=B.IDEFAB)
GROUP BY NOMFAB;
/*1.13*/
SELECT A.NOMFAB,AVG(B.PRECIO)
FROM FABRICANTE A INNER JOIN ARTICULO B 
ON (A.IDEFAB=B.IDEFAB)
GROUP BY NOMFAB
HAVING AVG(B.PRECIO)>19000;
/*1.15*/
SELECT NOMART
FROM ARTICULO
WHERE PRECIO=(SELECT MIN(PRECIO) FROM ARTICULO);
/*1.16*/
SELECT A.NOMFAB,B.PRECIO,B.NOMART
FROM FABRICANTE A INNER JOIN ARTICULO B 
ON (A.IDEFAB=B.IDEFAB)
WHERE B.PRECIO=(SELECT MAX(C.PRECIO) FROM ARTICULO C
WHERE C.IDEFAB=A.IDEFAB);
/*1.17*/
INSERT INTO ARTICULO (IDEART,IDEFAB,NOMART,PRECIO) VALUES (11,2,'LOGAN',16000.0);
/*1.18*/
UPDATE ARTICULO SET NOMART='ZAFIRA'WHERE IDEFAB=2;
/*1.19*/
UPDATE ARTICULO SET PRECIO=(PRECIO-PRECIO*0.1);
/*1.20*/
UPDATE ARTICULO SET PRECIO=(PRECIO-PRECIO*0.1)WHERE PRECIO>=100;


/*PRACTICA 2*/

CREATE TABLE DEPARTAMENTO(
   CODDEP VARCHAR2(12),
   NOMDEP VARCHAR2(12),
   PRESUPUESTO NUMBER(6,2),
   CONSTRAINT PK_DEPARTAMENTO PRIMARY KEY(CODDEP));

CREATE TABLE EMPLEADO(
   DNI VARCHAR2(12),
   CODDEP VARCHAR2(12),
   NOM VARCHAR2(12),
   APELLIDO VARCHAR2(12),
   CONSTRAINT PK_EMPLEADO PRIMARY KEY(DNI),
   CONSTRAINT FK_EMPLEADO_DEPARTAMENTO FOREIGN KEY (CODDEP) REFERENCES DEPARTAMENTO(CODDEP));
   
INSERT INTO DEPARTAMENTO (CODDEP,NOMDEP,PRESUPUESTO) VALUES ('1','DEP1',100);
INSERT INTO DEPARTAMENTO (CODDEP,NOMDEP,PRESUPUESTO) VALUES ('2','DEP2',200);
INSERT INTO DEPARTAMENTO (CODDEP,NOMDEP,PRESUPUESTO) VALUES ('3','DEP3',300);
INSERT INTO DEPARTAMENTO (CODDEP,NOMDEP,PRESUPUESTO) VALUES ('4','DEP4',400);

INSERT INTO EMPLEADO (DNI,CODDEP,NOM,APELLIDO) VALUES ('DNI1',1,'NOM1','APE1');
INSERT INTO EMPLEADO (DNI,CODDEP,NOM,APELLIDO) VALUES ('DNI2',2,'NOM2','APE2');
INSERT INTO EMPLEADO (DNI,CODDEP,NOM,APELLIDO) VALUES ('DNI3',2,'NOM3','APE2');
INSERT INTO EMPLEADO (DNI,CODDEP,NOM,APELLIDO) VALUES ('DNI4',4,'NOM4','LOPEZ');
COMMIT;

/*2.1*/
SELECT APELLIDO FROM EMPLEADO;
/*2.2*/
SELECT APELLIDO FROM EMPLEADO GROUP BY(APELLIDO);
/*2.3*/
SELECT * FROM EMPLEADO WHERE APELLIDO='APE2';
/*2.4*/
SELECT * FROM EMPLEADO WHERE (APELLIDO='APE2' OR APELLIDO='APE1');
/*2.5*/
SELECT * FROM EMPLEADO WHERE CODDEP='2';
/*2.6*/
SELECT * FROM EMPLEADO WHERE (CODDEP='4' OR CODDEP='2');
/*2.7*/
SELECT * FROM EMPLEADO WHERE (APELLIDO LIKE 'L%');
/*2.8*/
SELECT PRESUPUESTO,NOMDEP FROM DEPARTAMENTO;
/*2.9*/
SELECT A.NOMDEP, COUNT(*)
FROM DEPARTAMENTO A INNER JOIN EMPLEADO B
ON(A.CODDEP=B.CODDEP)
GROUP BY(A.NOMDEP)
HAVING COUNT(*)>=2;
/*2.10*/
SELECT A.*,B.*
FROM EMPLEADO A INNER JOIN DEPARTAMENTO B
ON(A.CODDEP=B.CODDEP);
/*2.11*/
SELECT A.NOM,A.APELLIDO,B.NOMDEP,B.PRESUPUESTO
FROM EMPLEADO A INNER JOIN DEPARTAMENTO B
ON(A.CODDEP=B.CODDEP);
/*2.12*/
SELECT A.NOM,A.APELLIDO,B.PRESUPUESTO
FROM EMPLEADO A INNER JOIN DEPARTAMENTO B
ON(A.CODDEP=B.CODDEP)
WHERE PRESUPUESTO>300;
/*2.13*/
SELECT NOMDEP,CODDEP
FROM DEPARTAMENTO 
WHERE PRESUPUESTO>(SELECT AVG (PRESUPUESTO) FROM DEPARTAMENTO);
/*2.14*/

SELECT A.NOMDEP, COUNT(*)
FROM DEPARTAMENTO A INNER JOIN EMPLEADO B
ON(A.CODDEP=B.CODDEP)
GROUP BY(A.NOMDEP)
HAVING COUNT(*)>=2;

/*2.15*/
INSERT INTO DEPARTAMENTO (CODDEP,NOMDEP,PRESUPUESTO) VALUES ('11','CALIDAD',40000);

INSERT INTO EMPLEADO (DNI,CODDEP,NOM,APELLIDO) VALUES ('89267109','11','ESTHER','VAZQUEZ');
COMMIT;
/*2.16*/
UPDATE DEPARTAMENTO SET PRESUPUESTO=(PRESUPUESTO+PRESUPUESTO*0.1);
/*2.17*/
UPDATE EMPLEADO SET CODDEP=1 WHERE CODDEP=4;
/*2.18*/
/*SELECT FROM EMPLEADO   WHERE (CODDEP=1);*/
DELETE FROM EMPLEADO   WHERE (CODDEP=1);
/*2.19*/
/*SELECT FROM EMPLEADO*/
DELETE FROM EMPLEADO   
WHERE CODDEP=(SELECT CODDEP FROM DEPARTAMENTO WHERE (PRESUPUESTO=220));

/*2.20*/ 
DELETE FROM EMPLEADO;

/*PRACTICA 3*/

CREATE TABLE ALMACEN(
   CODALM VARCHAR2(10),
   LUGAR VARCHAR2(10),
   CAPACIDAD NUMBER(3),
   CONSTRAINT PK_ALMACEN PRIMARY KEY (CODALM));
   
CREATE TABLE CAJAS(
   IDECAJ VARCHAR2(10),
   CODALM VARCHAR2(10),
   CONTENIDO VARCHAR2(10),
   VALOR NUMBER(3,2),
   CONSTRAINT PK_CAJAS PRIMARY KEY (IDECAJ),
   CONSTRAINT FK_CAJAS_ALMACEN FOREIGN KEY (CODALM) REFERENCES ALMACEN(CODALM));


INSERT INTO ALMACEN (CODALM,LUGAR,CAPACIDAD) VALUES ('COD1','ALCORCON',1);
INSERT INTO ALMACEN (CODALM,LUGAR,CAPACIDAD) VALUES ('COD2','MADRID',2);
INSERT INTO ALMACEN (CODALM,LUGAR,CAPACIDAD) VALUES ('COD3','MOSTOLES',3);
INSERT INTO ALMACEN (CODALM,LUGAR,CAPACIDAD) VALUES ('COD4','ALCOBENDAS',4);
COMMIT;

INSERT INTO CAJAS (IDECAJ,CODALM,CONTENIDO,VALOR) VALUES ('IDE1','COD1','CONTE1',1); 
INSERT INTO CAJAS (IDECAJ,CODALM,CONTENIDO,VALOR) VALUES ('IDE2','COD2','CONTE2',2); 
INSERT INTO CAJAS (IDECAJ,CODALM,CONTENIDO,VALOR) VALUES ('IDE3','COD3','CONTE3',3); 
INSERT INTO CAJAS (IDECAJ,CODALM,CONTENIDO,VALOR) VALUES ('IDE4','COD4','CONTE4',4); 
INSERT INTO CAJAS (IDECAJ,CODALM,CONTENIDO,VALOR) VALUES ('IDE5','COD3','CONTE4',8); 
INSERT INTO CAJAS (IDECAJ,CODALM,CONTENIDO,VALOR) VALUES ('IDE6','COD3','CONTE4',8); 
INSERT INTO CAJAS (IDECAJ,CODALM,CONTENIDO,VALOR) VALUES ('IDE7','COD3','CONTE4',8); 
COMMIT;
/*3.1*/
SELECT * FROM ALMACEN;
/*3.2*/
SELECT * FROM CAJAS WHERE (VALOR>3);
/*3.3*/
SELECT CONTENIDO FROM CAJAS;
/*3.4*/
SELECT AVG(VALOR) FROM CAJAS;
/*3.5*/
SELECT CODALM,AVG(VALOR) FROM CAJAS
GROUP BY (CODALM);
/*3.6*/
SELECT CODALM,AVG(VALOR) FROM CAJAS
GROUP BY (CODALM)
HAVING AVG(VALOR)>2;
/*3.7*/
SELECT C.IDECAJ,B.LUGAR
FROM CAJAS C INNER JOIN ALMACEN B
ON(C.CODALM=B.CODALM);
/*3.8*/
SELECT A.CODALM,COUNT(*)
FROM ALMACEN A INNER JOIN CAJAS B
ON(A.CODALM=B.CODALM)
GROUP BY(A.CODALM);
/*3.9*/

/*SELECT A.CODALM*/
SELECT A.CODALM
FROM ALMACEN A INNER JOIN CAJAS B
ON (A.CODALM=B.CODALM)
WHERE CAPACIDAD<(SELECT COUNT(*) FROM CAJAS C
                 WHERE C.CODALM=A.CODALM
                 GROUP BY C.CODALM)
GROUP BY A.CODALM;

/*3.10*/
SELECT A.IDECAJ,B.LUGAR
FROM CAJAS A INNER JOIN ALMACEN B
ON(A.CODALM=B.CODALM)
WHERE (B.LUGAR='ALCORCON');
/*3.11*/
INSERT INTO ALMACEN (CODALM,LUGAR,CAPACIDAD) VALUES ('COD5','BARCELONA',3);
/*3.12*/
INSERT INTO CAJAS (IDECAJ,CODALM,CONTENIDO,VALOR) VALUES ('H5R T','COD2','PAPEL',200); 
/*3.13*/
UPDATE CAJAS SET VALOR=(VALOR-VALOR*0.15);
/*3.14*/
UPDATE CAJAS SET VALOR=(VALOR-VALOR*0.20) 
WHERE VALOR>(SELECT AVG (VALOR) FROM CAJAS);
/*3.15*/
/*SELECT FROM CAJAS WHERE VALOR<4;*/
DELETE FROM CAJAS WHERE VALOR<4;
/*3.16*/
/*SELECT FROM CAJAS*/
DELETE FROM CAJAS 
WHERE CODALM=(SELECT A.CODALM
FROM ALMACEN A INNER JOIN CAJAS B
ON (A.CODALM=B.CODALM)
WHERE CAPACIDAD<(SELECT COUNT(*) FROM CAJAS C
                 WHERE C.CODALM=A.CODALM
                 GROUP BY C.CODALM)
GROUP BY A.CODALM);

/*PRACTICA 4*/

CREATE TABLE PELICULAS(

    CODPEL VARCHAR2(12),
    NOMPEL VARCHAR2(12),
    CALIFI_EDAD VARCHAR2(12),
    CONSTRAINT PK_PELICULAS PRIMARY KEY(CODPEL));
    
CREATE TABLE SALAS(
   CODSAL VARCHAR2(12),
   CODPEL VARCHAR2(12),
   NOMSAL VARCHAR2(25),
   CONSTRAINT PK_SALAS PRIMARY KEY (CODSAL),
   CONSTRAINT FK_SALAS_PELICULAS FOREIGN KEY (CODPEL) REFERENCES PELICULAS(CODPEL));

INSERT INTO PELICULAS (CODPEL,NOMPEL,CALIFI_EDAD) VALUES ('CODPEL1','PEL3','CAL1');
INSERT INTO PELICULAS (CODPEL,NOMPEL,CALIFI_EDAD) VALUES ('CODPEL2','PEL1','CAL2');
INSERT INTO PELICULAS (CODPEL,NOMPEL,CALIFI_EDAD) VALUES ('CODPEL3','PEL2','CAL2');
INSERT INTO PELICULAS (CODPEL,NOMPEL,CALIFI_EDAD) VALUES ('CODPEL4','PEL2','CAL4');
INSERT INTO PELICULAS (CODPEL,NOMPEL,CALIFI_EDAD) VALUES ('CODPEL5','PEL2',NULL);
INSERT INTO PELICULAS (CODPEL,NOMPEL,CALIFI_EDAD) VALUES ('CODPEL6','CHARLIEBROWN','CAL4');
INSERT INTO PELICULAS (CODPEL,NOMPEL,CALIFI_EDAD) VALUES ('CODPEL7','AVATAR','TODOS');
COMMIT;

INSERT INTO SALAS (CODSAL,CODPEL,NOMSAL) VALUES ('CODSAL1','CODPEL1','SALA1');
INSERT INTO SALAS (CODSAL,CODPEL,NOMSAL) VALUES ('CODSAL2','CODPEL2','SALA2');
INSERT INTO SALAS (CODSAL,CODPEL,NOMSAL) VALUES ('CODSAL3','CODPEL3','SALA3');
INSERT INTO SALAS (CODSAL,CODPEL,NOMSAL) VALUES ('CODSAL4','CODPEL4','SALA4');
INSERT INTO SALAS (CODSAL,CODPEL,NOMSAL) VALUES ('CODSAL5',NULL,'SALA5');
INSERT INTO SALAS (CODSAL,CODPEL,NOMSAL) VALUES ('CODSAL6',NULL,'SALA6');
COMMIT;

/*4.1*/
SELECT NOMPEL FROM PELICULAS GROUP BY NOMPEL;
/*4.2*/
SELECT CALIFI_EDAD FROM PELICULAS GROUP BY CALIFI_EDAD;
/*4.3*/
SELECT NOMPEL,CODPEL FROM PELICULAS WHERE CALIFI_EDAD IS NULL;
/*4.4*/
SELECT CODSAL,NOMSAL FROM SALAS WHERE CODPEL IS NULL;
/*4.5*/
SELECT B.CODSAL,A.CODPEL
FROM PELICULAS A RIGHT JOIN SALAS B
ON (A.CODPEL=B.CODPEL);

/*4.6*/
SELECT A.CODPEL,B.NOMSAL
FROM PELICULAS A LEFT JOIN SALAS B
ON (A.CODPEL=B.CODPEL);
/*4.7*/
SELECT A.CODPEL
FROM PELICULAS A LEFT JOIN SALAS B
ON (A.CODPEL=B.CODPEL)
WHERE B.CODPEL IS NULL;
/*4.8*/
INSERT INTO PELICULAS (CODPEL,NOMPEL,CALIFI_EDAD) VALUES ('CODPEL7','UNO, DOS ,TRES','+7');
/*4.9*/
UPDATE PELICULAS SET CALIFI_EDAD='no recom. -13'
WHERE (CALIFI_EDAD IS NULL);
/*4.10*/
/*SELECT FROM PELICULAS*/
DELETE FROM PELICULAS
WHERE CALIFI_EDAD='TODOS';

/*PRACTICA 5*/

CREATE TABLE DESPACHO(
   CODDES VARCHAR2(20),
   CAPACIDAD NUMBER(3),
   CONSTRAINT PK_DESPACHO PRIMARY KEY (CODDES));

CREATE TABLE JEFE(
   DNIJEF VARCHAR2(20),
   NOMJEF VARCHAR2(20),
   APEJEF VARCHAR2(20),
   CONSTRAINT PK_JEFE PRIMARY KEY (DNIJEF));
   
CREATE TABLE DIRECTOR(
   DNIDIR VARCHAR2(20),
   CODDES VARCHAR2(20),
   DNIJEF VARCHAR2(20),
   NOMDIR VARCHAR2(20),
   APEDIR VARCHAR2(20),
   CONSTRAINT PK_DIRECTOR PRIMARY KEY (DNIDIR),
   CONSTRAINT FK_DIRECTOR_JEFE FOREIGN KEY (DNIJEF) REFERENCES JEFE(DNIJEF),
   CONSTRAINT FK_DIRECTOR_DESPACHO FOREIGN KEY (CODDES) REFERENCES DESPACHO(CODDES));
   
INSERT INTO DESPACHO (CODDES,CAPACIDAD) VALUES ('CODDES1',10);
INSERT INTO DESPACHO (CODDES,CAPACIDAD) VALUES ('CODDES2',20);
INSERT INTO DESPACHO (CODDES,CAPACIDAD) VALUES ('CODDES3',90);
INSERT INTO DESPACHO (CODDES,CAPACIDAD) VALUES ('CODDES4',10);
INSERT INTO DESPACHO (CODDES,CAPACIDAD) VALUES ('CODDES5',2);
COMMIT;

INSERT INTO JEFE (DNIJEF,NOMJEF,APEJEF) VALUES ('DNIJEF1','NOMJEF1','APEJEF1');
INSERT INTO JEFE (DNIJEF,NOMJEF,APEJEF) VALUES ('DNIJEF2','NOMJEF2','APEJEF2');
INSERT INTO JEFE (DNIJEF,NOMJEF,APEJEF) VALUES ('DNIJEF3','NOMJEF3','APEJEF1');
INSERT INTO JEFE (DNIJEF,NOMJEF,APEJEF) VALUES ('DNIJEF4','NOMJEF2','APEJEF4');
INSERT INTO JEFE (DNIJEF,NOMJEF,APEJEF) VALUES ('DNIJEF5','NOMJEF2','APEJEF4');
COMMIT;

INSERT INTO DIRECTOR (DNIDIR,CODDES,DNIJEF,NOMDIR,APEDIR) VALUES ('DNIDIR1','CODDES1','DNIJEF1','NOMDIR1','APEDIR1');
INSERT INTO DIRECTOR (DNIDIR,CODDES,DNIJEF,NOMDIR,APEDIR) VALUES ('DNIDIR2','CODDES2','DNIJEF2','NOMDIR2','APEDIR2');
INSERT INTO DIRECTOR (DNIDIR,CODDES,DNIJEF,NOMDIR,APEDIR) VALUES ('DNIDIR3','CODDES2','DNIJEF3','NOMDIR3','APEDIR3');
INSERT INTO DIRECTOR (DNIDIR,CODDES,DNIJEF,NOMDIR,APEDIR) VALUES ('DNIDIR4','CODDES3','DNIJEF4','NOMDIR2','APEDIR1');
INSERT INTO DIRECTOR (DNIDIR,CODDES,DNIJEF,NOMDIR,APEDIR) VALUES ('DNIDIR5','CODDES4',NULL,'NOMDIR2','APEDIR1');
INSERT INTO DIRECTOR (DNIDIR,CODDES,DNIJEF,NOMDIR,APEDIR) VALUES ('DNIDIR6','CODDES4',NULL,'NOMDIR2','APEDIR1');
INSERT INTO DIRECTOR (DNIDIR,CODDES,DNIJEF,NOMDIR,APEDIR) VALUES ('DNIDIR7','CODDES4',NULL,'NOMDIR2','APEDIR1');
INSERT INTO DIRECTOR (DNIDIR,CODDES,DNIJEF,NOMDIR,APEDIR) VALUES ('DNIDIR8','CODDES4',NULL,'NOMDIR2','APEDIR1');
INSERT INTO DIRECTOR (DNIDIR,CODDES,DNIJEF,NOMDIR,APEDIR) VALUES ('DNIDIR9','CODDES4',NULL,'NOMDIR2','APEDIR1');
INSERT INTO DIRECTOR (DNIDIR,CODDES,DNIJEF,NOMDIR,APEDIR) VALUES ('DNIDIR10','CODDES4',NULL,'NOMDIR2','APEDIR1');
INSERT INTO DIRECTOR (DNIDIR,CODDES,DNIJEF,NOMDIR,APEDIR) VALUES ('DNIDIR11','CODDES5',NULL,'NOMDIR2','APEDIR1');
INSERT INTO DIRECTOR (DNIDIR,CODDES,DNIJEF,NOMDIR,APEDIR) VALUES ('DNIDIR12','CODDES5',NULL,'NOMDIR2','APEDIR1');
INSERT INTO DIRECTOR (DNIDIR,CODDES,DNIJEF,NOMDIR,APEDIR) VALUES ('DNIDIR13','CODDES5',NULL,'NOMDIR2','APEDIR1');
INSERT INTO DIRECTOR (DNIDIR,CODDES,DNIJEF,NOMDIR,APEDIR) VALUES ('DNIDIR14','CODDES3','DNIJEF4','NOMDIR2','APEDIR1');
COMMIT;

/*5.1*/
SELECT DNIDIR,NOMDIR,APEDIR FROM DIRECTOR;
/*5.2*/
SELECT DNIDIR,NOMDIR,APEDIR FROM DIRECTOR
WHERE DNIJEF IS NULL;
/*5.3*/
SELECT A.NOMDIR,A.APEDIR,B.CAPACIDAD
FROM DIRECTOR A INNER JOIN DESPACHO B
ON(A.CODDES=B.CODDES);
/*5.4*/
SELECT A.CODDES, COUNT(*)
FROM DESPACHO A INNER JOIN DIRECTOR B
ON(A.CODDES=B.CODDES)
GROUP BY(A.CODDES);
/*5.5*/
SELECT A.DNIJEF,COUNT(*)
FROM JEFE A INNER JOIN DIRECTOR B
ON(A.DNIJEF=B.DNIJEF)
GROUP BY(A.DNIJEF);

/*5.6*/
SELECT A.NOMDIR,A.APEDIR,B.NOMJEF,B.APEJEF
FROM DIRECTOR A INNER JOIN JEFE B
ON(A.DNIJEF=B.DNIJEF);
/*5.7*/
SELECT A.CODDES,COUNT(*)
FROM DESPACHO A INNER JOIN DIRECTOR B
ON (A.CODDES=B.CODDES)
WHERE CAPACIDAD<(SELECT COUNT(*) FROM DIRECTOR C
                 WHERE C.CODDES=A.CODDES
                 GROUP BY C.CODDES)
GROUP BY A.CODDES;
/*5.8*/
INSERT INTO DESPACHO (CODDES,CAPACIDAD) VALUES ('124',10);
INSERT INTO DIRECTOR (DNIDIR,CODDES,DNIJEF,NOMDIR,APEDIR) VALUES ('28301700','124',NULL,'Paco','Perez');
/*5.9*/
INSERT INTO JEFE (DNIJEF,NOMJEF,APEJEF) VALUES ('74568521','NUEVOJEF','APEJEF1');
/*SELECT APEDIR FROM DIRECTOR WHERE APEDIR='Perez';*/
UPDATE DIRECTOR SET DNIJEF='74568521'
WHERE APEDIR='Perez';
/*5.10*/
/*SELECT DNIJEF FROM DIRECTOR WHERE (DNIJEF IS NOT NULL);*/
DELETE FROM DIRECTOR WHERE(DNIJEF IS NOT NULL);

/*PRACTICA 6*/

/*6.1*/ 
SELECT A.CODALM
FROM ALMACEN A INNER JOIN CAJAS B
ON (A.CODALM=B.CODALM)
WHERE CAPACIDAD<(SELECT COUNT(*) FROM CAJAS C
                 WHERE C.CODALM=A.CODALM
                 GROUP BY C.CODALM)
GROUP BY A.CODALM
HAVING A.CODALM!='SDRG'
ORDER BY CODALM ASC;

/*SELECT CON WHERE*/
    SELECT * FROM DEPARTAMENTO
    WHERE(PRESUPUESTO>70000);
/*SELECT CON GROUP BY*/
    SELECT CODALM,AVG(VALOR) FROM CAJAS
    GROUP BY (CODALM);
/*SELECT CON HAVING*/
    SELECT A.CODALM
    FROM ALMACEN A INNER JOIN CAJAS B
    ON (A.CODALM=B.CODALM)
    WHERE CAPACIDAD<(SELECT COUNT(*) FROM CAJAS C
                 WHERE C.CODALM=A.CODALM
                 GROUP BY C.CODALM);
/*SELECT CON ORDER*/
    SELECT CODDES FROM DESPACHO
    ORDER BY CODDES ASC;

/*6.2*/
/*EJEMPLO INNER JOIN*/
SELECT A.DNIJEF,COUNT(*)
FROM JEFE A INNER JOIN DIRECTOR B
ON(A.DNIJEF=B.DNIJEF)
GROUP BY(A.DNIJEF);

/*EJEMPLO RIGHT JOIN*/

SELECT B.CODSAL,A.CODPEL
FROM PELICULAS A RIGHT JOIN SALAS B
ON (A.CODPEL=B.CODPEL);

/*EJEMPLO LEFT JOIN*/

SELECT A.CODPEL,B.NOMSAL
FROM PELICULAS A LEFT JOIN SALAS B
ON (A.CODPEL=B.CODPEL);

/*6.3*/

/*EJEMPLO UNION*/
SELECT DNIJEF,NOMJEF FROM JEFE
UNION
SELECT DNIDIR,NOMDIR FROM DIRECTOR;
/*EJEMPLO INTERSECT*/
SELECT DNIJEF,NOMJEF FROM JEFE
INTERSECT
SELECT DNIJEF,NOMDIR FROM DIRECTOR;
/*EJEMPLO MINUS*/
SELECT  DNIDIR,NOMDIR FROM DIRECTOR
MINUS
SELECT DNIJEF,NOMJEF FROM JEFE;

/*6.4*/

/*EJEMPLO COUNT*/
SELECT COUNT(*) FROM DIRECTOR;
/*EJEMPLO SUM*/
SELECT SUM(VALOR)/COUNT(*) FROM CAJAS;
/*EJEMPLO MAX*/
SELECT NOMART
FROM ARTICULO
WHERE PRECIO=(SELECT MAX(PRECIO) FROM ARTICULO);
/*EJEMPLO MIN*/
SELECT NOMART
FROM ARTICULO
WHERE PRECIO=(SELECT MIN(PRECIO) FROM ARTICULO);
/*EJEMPLO AVG*/
SELECT AVG(VALOR) FROM CAJAS;

/*6.5*/ 

/*EJEMPLO NULL*/
SELECT DNIDIR,NOMDIR,APEDIR FROM DIRECTOR
WHERE DNIJEF IS NULL;

/*EJEMPLO NOT NULL*/
DELETE FROM DIRECTOR WHERE(DNIJEF IS NOT NULL);
/*EJEMPLO IN*/
SELECT IDECAJ FROM CAJAS 
WHERE VALOR IN (1,2,3,4);
/* -Subconsulta-*/            
SELECT IDECAJ FROM CAJAS
WHERE VALOR IN (SELECT VALOR FROM CAJAS WHERE VALOR>0 AND VALOR<5);
/*EJEMPLO NOT IN*/
SELECT IDECAJ FROM CAJAS
WHERE VALOR NOT IN (1,2,3,4);
/*EJEMPLO BETWEEN*/
SELECT NOMART
FROM ARTICULO
WHERE PRECIO BETWEEN 1000 AND 20000;
/*EJEMPLO ANY*/
SELECT IDECAJ FROM CAJAS
WHERE VALOR>=3 AND
IDECAJ=ANY(SELECT IDECAJ FROM CAJAS
      WHERE VALOR IS NOT NULL);
/*EJEMPLO ALL*/
SELECT IDECAJ FROM CAJAS
WHERE VALOR>=2 AND
IDECAJ=ALL(SELECT IDECAJ FROM CAJAS
      WHERE VALOR IS NOT NULL);
/*6.6*/
INSERT INTO JEFE (DNIJEF,NOMJEF,APEJEF) VALUES ('DNIJEF4','NOMJEF2','APEJEF4');
/*6.7*/
UPDATE EMPLEADO SET CODDEP=1 WHERE CODDEP=4;
/*6.8*/
DELETE FROM CAJAS WHERE VALOR<4;










